@page "/"
@inject WeaponService weaponService
@inject StickerService stickerService

<PageTitle>Index</PageTitle>



<section id="skingenerator">
    <div class="wrapper">
        <div class="container py-14 py-md-17">

            @if (SelectedWeapon is not null)
            {

                <div class="input-group mb-3">
                    <div class="form-floating">
                        <input type="text" value="@SelectedWeapon.GetGencode(Float, Pattern, SelectedStickers)" class="form-control" placeholder="Gencode" id="gencode" />
                        <label for="gencode">Gencode</label>
                    </div>
                    <button type="button" class="btn btn-primary" onclick="copyGencode()"><i class="fa-solid fa-copy"></i></button>
                </div>


            }

            <div class="generator-wrapper">

                <div class="weapon-wrapper">
                    <div class="form-floating mb-3">
                        <input type="text" @bind="WeaponFilter.Searchterm" @bind:event="oninput" class="form-control" placeholder="Search weapon" id="search-weapon" />
                        <label for="search-weapon">Search weapon</label>
                    </div>
                    @foreach (var weapon in weaponService.SearchWeapon(WeaponFilter))
                    {
                        <DisplayWeapon Weapon="weapon" OnClick="OnWeaponClicked" />
                    }
                </div>

                <div class="sticker-wrapper">
                    <div class="form-floating mb-3">
                        <input type="text" @bind="StickerFilter.Searchterm" @bind:event="oninput" class="form-control" placeholder="Search stickers" id="search-stickers" />
                        <label for="search-stickers">Search stickers</label>
                    </div>
                    @foreach (var sticker in stickerService.SearchSticker(StickerFilter))
                    {
                        <DisplaySticker Sticker="sticker" OnClick="OnStickerClicked" />
                    }
                </div>

                <div class="options-wrapper">
                    <div class="form-floating mb-3">
                        <input type="number" @bind="Float" class="form-control" step=".01" max="1" min="0" placeholder="Float" id="float" />
                        <label for="float">Float</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="number" @bind="Pattern" class="form-control" step="1" max="1000" min="0" placeholder="Pattern" id="pattern" />
                        <label for="pattern">Pattern</label>
                    </div>

                    <h3 class="text-white">Selected stickers</h3>

                    @foreach (var sticker in SelectedStickers)
                    {
                        <div class="selected-sticker">
                            <h5>@sticker.name</h5>
                            <div class="form-floating mb-3">
                                <input type="number" @bind="sticker.Scratched" @bind:event="oninput" class="form-control" step="0.01" max="1" min="0" placeholder="Scratched" id="@($"selected-sticker-{sticker.GetHashCode()}")" />
                                <label for="@($"selected-sticker-{sticker.GetHashCode()}")">Scratched</label>
                            </div>
                            <button type="button" @onclick="() => SelectedStickers.Remove(sticker)" class="btn btn-danger">Remove</button>
                        </div>
                    }

                    @if (SelectedStickers.Any())
                    {
                        <button type="button" class="btn btn-danger" @onclick="() => SelectedStickers.RemoveAt(SelectedStickers.Count - 1)">Remove last sticker</button>
                        <button type="button" class="btn btn-danger" @onclick="() => SelectedStickers.Clear()">Remove all stickers</button>
                    }
                </div>


            </div>
        
            <div class="changelog">
                <h3 class="text-white">Changelog</h3>
                <ul>
                    <li>2023-05-02
                        <ul>
                            <li>Added missing stickers to Community Sticker Capsule 1</li>
                            <li>Added Berlin 2019 stickers</li>
                            <li>Added RMR 2020 stickers</li>
                            <li>Added Rio 2022 stickers</li>
                        </ul>
                    </li>
                    <li>2023-05-01
                        <ul>
                            <li>Added Antwerp 2022 stickers</li>
                            <li>Added Community Sticker Capsules stickers</li>
                            <li>Added Stockholm 2021 stickers</li>
                            <li>Added all missing skin collections</li>
                            <li>Added dark mode</li>
                            <li>Added copy gencode button</li>
                            <li>Added social media links on bottom of page</li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>










